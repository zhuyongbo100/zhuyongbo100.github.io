(self["webpackChunkproject_v2"]=self["webpackChunkproject_v2"]||[]).push([[2938],{22849:function(e,t,n){var a=n(1853);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var i=n(56).Z;i("51c6dbd6",a,!0,{sourceMap:!1,shadowMode:!1})},26586:function(e,t,n){var a=n(18723);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var i=n(56).Z;i("2b70e9d9",a,!0,{sourceMap:!1,shadowMode:!1})},74130:function(e,t,n){var a=n(30934);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var i=n(56).Z;i("36683727",a,!0,{sourceMap:!1,shadowMode:!1})},37411:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var a,i,r={publicModule:n(60693).Z,liuDragButton:n(30852).Z},o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"workbench-page"},[n("v-uni-view",{staticClass:"content"},[e._l(e.appList,(function(e,t){return n("AppItem",{key:t,staticClass:"app-item",attrs:{path:e.path,icon:e.icon,name:e.name,count:e.count}})}))],2),n("customTabbar",{attrs:{activeIndex:e.bottomTabIndex}}),n("public-module"),n("liu-drag-button",{on:{clickBtn:function(t){arguments[0]=t=e.$handleEvent(t),e.goAI.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"pos-btn"},[n("v-uni-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.$base.staticUrl+"/image/ai-logo.gif",mode:"aspectFit"}}),n("h5",[e._v("Hi~我是小H")]),n("h5",[e._v("你的AI助理")])],1)],1)],1)},s=[],u=n(66407),p=n(4587),c=n(41541),d=(n(50886),n(76801),n(43843),n(38077),n(60228),n(34338),n(70560),n(65137),n(32320),n(79288),n(91012)),l=n(80843),f=n(4626),g=n(9908),m={uBadge:n(71049).Z},h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"app-item",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleGoto.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"item-image"},[n("v-uni-image",{attrs:{src:e.icon,mode:"aspectFit"}}),n("u-badge",{attrs:{type:"error",max:"99",value:e.count,absolute:!0,offset:[-5,-5]}})],1),n("span",[e._v(e._s(e.name))])],1)},v=[],y={props:{name:{type:String,default:"",required:!0},icon:{type:String,default:"",required:!0},path:{type:String,default:"",required:!0},count:{type:Number,default:0}},data:function(){return{base:d.Z}},methods:{handleGoto:function(){uni.navigateTo({url:this.path})}}},I=y,b=(n(22849),n(69453)),x=(0,b.Z)(I,h,v,!1,null,"e38b47ce",null,!1,m,a),w=x.exports,C={name:"index",components:{customTabbar:g.Z,AppItem:w},data:function(){return{base:d.Z,bottomTabIndex:1,appList:[],count:{},info:{njzr:{},rkzr:{}},appListCopy:[]}},computed:(0,c.Z)((0,c.Z)((0,c.Z)({},(0,l.mapState)(["userInfo","studentInfo","appType","courseRelation","currentCourseRelation","mpSource"])),(0,l.mapGetters)(["selectedStudent","isLogin","userType"])),{},{userTypeNew:function(){if(3==this.appType)return 1;var e=this.userInfo.roleList||this.userInfo.roles||[],t=e.map((function(e){return e.roleKey}));return t.includes("notice_manager")?4:2==this.appType?this.info.njzr?2:this.info.rkzr?3:5:6},userRoles:function(){var e=this;if(this.userInfo.userOrganizations&&this.userInfo.userOrganizations.length){var t=this.userInfo.userOrganizations.filter((function(t){return t.organizationId===e.userInfo.organizationId}));return t&&t.length?t[0].roleList:[]}return this.userInfo.roles||[]}}),onShow:function(){var e=this;return(0,p.Z)((0,u.Z)().mark((function t(){return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.appType&&e.isLogin){t.next=3;break}return(0,f.UY)({url:"/pages/login/login"}),t.abrupt("return");case 3:if(1!=e.appType){t.next=12;break}return t.next=6,e.getStudentList();case 6:if(!(0,f.xb)(e.studentInfo)){t.next=9;break}return uni.reLaunch({url:"/pages_common/pages/bindStudent?from=reLaunch"}),t.abrupt("return");case 9:if(e.selectedStudent&&e.selectedStudent.name){t.next=12;break}return uni.reLaunch({url:"/pages_common/pages/selectStudent?from=reLaunch"}),t.abrupt("return");case 12:if(2!=e.appType&&3!=e.appType){t.next=15;break}return t.next=15,e.ApiIsNjzr();case 15:e.getApp();case 16:case"end":return t.stop()}}),t)})))()},methods:(0,c.Z)((0,c.Z)({ApiIsNjzr:function(){var e=this;return(0,p.Z)((0,u.Z)().mark((function t(){return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.userInfo.organizationId){t.next=4;break}return t.next=3,e.$api.message.isNjz(e.userInfo.organizationId,e.userInfo.uid);case 3:e.info=t.sent;case 4:case"end":return t.stop()}}),t)})))()}},(0,l.mapMutations)(["setStudentInfo"])),{},{getApp:function(){var e=this;return(0,p.Z)((0,u.Z)().mark((function t(){var n,a,i;return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=[],a={},1==e.appType?a={tenantId:e.selectedStudent.tenantId,organizationId:e.selectedStudent.schoolId,dictCode:"student"}:2!=e.appType&&3!=e.appType||(a={tenantId:e.userInfo.tenantId,organizationId:e.userInfo.organizationId,dictCode:"teacher"}),i=[{path:"/pages_apply/pages/applyList",name:"我的申请",icon:"/static/image/icon-apply-list.png",serviceCode:"myApplication"}],2!=e.appType&&3!=e.appType){t.next=8;break}return t.next=7,e.getCount();case 7:i=i.concat([{path:"/pages_apply/pages/copyList",name:"我的抄送",icon:"/static/image/icon-copy.png",count:e.count.copyNum||0,serviceCode:"myCc"}]);case 8:4!=e.userType&&(i=i.concat([{path:"/pages_apply/pages/approveList",name:"审批记录",icon:"/static/image/icon-approve.png",count:e.count.approve||0,serviceCode:"approvalRecords"}])),i.push({path:"/pages_message/pages/index",name:"通知公告",icon:"/static/image/icon-msg.png",serviceCode:"notificationAnnouncement"},{path:"/pages_address/pages/index",name:"通讯录",icon:"/static/image/icon-address.png",serviceCode:"contacts"},{path:"/pages_attendance/pages/index",name:"考勤打卡",icon:"/static/image/attence.png",serviceCode:"attendanceAndClockIn"},{path:"/pages_score/pages/index",name:"学生成绩",icon:"/static/image/icon-score.png",serviceCode:"studentAchievement"}),a.tenantId,e.$api.apply.getAppList(a).then((function(t){t&&t.length>0&&(n=t.filter((function(e){return"teacher_supply"!==e.code})).map((function(e){return{path:"".concat(e.route,"?categoryId=").concat(e.categoryId,"&title=").concat(e.categoryName,"&code=").concat(e.code),name:e.categoryName,icon:e.categoryUrl||"/static/image/icon-apply.png",serviceCode:e.code||null,type:"supply",seq:e.seq}}))),e.appListCopy=n.concat(i),e.$api.other.workApps({organizationId:e.userInfo.organizationId,type:"1",roleIds:e.userRoles.map((function(e){return e.roleId})).join(","),userTypes:String(e.userTypeNew),state:1}).then((function(t){var n=t||[],a=n.map((function(e){return e.serviceCode}));e.appList=e.appListCopy.filter((function(e){return a.includes(e.serviceCode)||"supply"===e.type})).map((function(e){if(a.includes(e.serviceCode)){var t=n.filter((function(t){return t.serviceCode===e.serviceCode}))[0];return(0,c.Z)((0,c.Z)({},e),{},{icon:t.moduleUrl||e.icon,name:t.moduleName||e.name,seq:parseInt(t.seq)||0})}return(0,c.Z)((0,c.Z)({},e),{},{seq:e.seq-100})})).sort((function(e,t){return e.seq>t.seq?1:-1}))}));var a=2===parseInt(e.appType)||3===parseInt(e.appType)?"1":"2",r=2===parseInt(e.appType)||3===parseInt(e.appType)?e.userInfo.uid:null,o=1===parseInt(e.appType)?e.selectedStudent.xsId:null,s=1==e.appType?e.selectedStudent.schoolId:e.userInfo.organizationId;e.$api.message.msgNoRead(s,{pageNum:1,pageSize:1e6,receiveType:a,receiveUid:r,studentId:o}).then((function(t){e.appList.map((function(n,a){"通知公告"===n.name&&e.$set(e.appList[a],"count",Number(t.total||"0"))}))}))}));case 12:case"end":return t.stop()}}),t)})))()},getCount:function(){var e=this;return this.$api.apply.getWorkbenchCount({tenantId:this.userInfo.tenantId,organizationId:this.userInfo.organizationId}).then((function(t){e.count=t}))},getStudentList:function(){var e=this;return(0,p.Z)((0,u.Z)().mark((function t(){return(0,u.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.userInfo.uid){t.next=4;break}return t.abrupt("return",e.$api.student.getStudents(e.userInfo.uid).then((function(t){e.setStudentInfo(t)})));case 4:return uni.$u.toast("用户uid不存在"),t.abrupt("return",!1);case 6:case"end":return t.stop()}}),t)})))()},goAI:function(){uni.navigateTo({url:"/pages_ai/pages/chat"})}})},Z=C,T=(n(26586),(0,b.Z)(Z,o,s,!1,null,"f341f3e4",null,!1,r,i)),k=T.exports},81871:function(e,t,n){"use strict";var a;n.d(t,{Z:function(){return l}});var i,r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"u-safe-bottom",class:[!e.isNvue&&"u-safe-area-inset-bottom"],style:[e.style]})},o=[],s={props:{}},u={name:"u-safe-bottom",mixins:[uni.$u.mpMixin,uni.$u.mixin,s],data:function(){return{safeAreaBottomHeight:0,isNvue:!1}},computed:{style:function(){var e={};return uni.$u.deepMerge(e,uni.$u.addStyle(this.customStyle))}},mounted:function(){}},p=u,c=(n(74130),n(69453)),d=(0,c.Z)(p,r,o,!1,null,"eca591a4",null,!1,a,i),l=d.exports},1853:function(e,t,n){"use strict";n.r(t);var a=n(8081),i=n.n(a),r=n(23645),o=n.n(r),s=o()(i());s.push([e.id,'@charset "UTF-8";\n/* uview 颜色变量 */.app-item[data-v-e38b47ce]{display:flex;flex-direction:column;align-items:center}.app-item .item-image[data-v-e38b47ce]{position:relative;display:flex;justify-content:center;align-items:center;width:%?120?%;height:%?120?%;margin-bottom:%?20?%;background:#fff;box-shadow:0 %?5?% %?25?% %?2?% rgba(18,42,105,.1);border-radius:%?20?%}.app-item .item-image uni-image[data-v-e38b47ce]{width:%?80?%;height:%?80?%}.app-item .item-image .item-badge[data-v-e38b47ce]{position:absolute;top:0;right:0}.app-item span[data-v-e38b47ce]{font-size:%?28?%;font-family:Source Han Sans CN;font-weight:500;color:#505050}',""]),t["default"]=s},18723:function(e,t,n){"use strict";n.r(t);var a=n(8081),i=n.n(a),r=n(23645),o=n.n(r),s=o()(i());s.push([e.id,'@charset "UTF-8";\n/* uview 颜色变量 */.workbench-page .content[data-v-f341f3e4]{display:flex;justify-content:flex-start;flex-wrap:wrap;padding-top:%?50?%;width:%?750?%;background:#f5f7f8;border-radius:%?30?% %?30?% %?0?% %?0?%}.workbench-page .app-item[data-v-f341f3e4]{width:33.3%;height:%?230?%}.workbench-page .pos-btn[data-v-f341f3e4]{width:100px;height:135px;display:flex;flex-direction:column;justify-content:center;align-items:center}.workbench-page .pos-btn h5[data-v-f341f3e4]{width:100px;text-align:center;font-size:%?26?%;color:#3c9cff}',""]),t["default"]=s},30934:function(e,t,n){"use strict";n.r(t);var a=n(8081),i=n.n(a),r=n(23645),o=n.n(r),s=o()(i());s.push([e.id,'@charset "UTF-8";\n/* uview 颜色变量 */.u-safe-bottom[data-v-eca591a4]{width:100%}',""]),t["default"]=s}}]);